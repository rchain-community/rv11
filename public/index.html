<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Ballot Experiment - RChain</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="./_dist_/vendor/rnode-client-js/src/web/favicon.ico" />
    <style>
      body { padding-top: 120px; }
      .coop { background: #eba3bb; /* reddish for RChain */ }
      #agendaUriViz {  border: 2px dotted red; }
      #deployStatus { background: lightyellow }
      .setting { text-align: right }
      table td.choice { text-align: center; }
    </style>
    <link rel="stylesheet" href="https://shepherdjs.dev/dist/css/shepherd.css" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous" />
  </head>
  <body>
    <nav class="navbar fixed-top navbar-light bg-light">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="https://github.com/rchain-community/">
            <img alt="RChain Community" src="https://avatars1.githubusercontent.com/u/43198800?s=88&v=4">
          </a>
        </div>
        <div class="progress" style="width: 50%">
          <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
        </div>

        <button id="signIn" class="navbar-right">Sign In</button>
        <p class="navbar-text navbar-right">Signed in as <span id="addrViz" class="btn vizHash">...</span>
        <br />
        <em id="deployStatus">...</em>
      </p>

      </div>
    </nav>
    <div class="app container">
      <div class="testNet">
        <div>
          <h4>RChain Annual Meeting 2020 Ballot <sup>(Beta Test2)</sup></h4>
          <hr />
          <button id='startTour' class="btn btn-primary">Show Me How</button>
          <br>
        </div>
        <ol><small>

          <li>Do you have a REV Address registered with the coop? If not, see the meeting notice for instructions.
          </li><li>Press Sign In to connect to Metamask. Choose the ethereum account corresponding to your REV address.
              </li><li>Once you are signed in, after a short pause to get the ballot from RChain, the questions are presented along with links for more information.
          
          </li><li>As you choose your responses, the rholang transactions representing your responses will be prepared for you.
          
          </li><li>Voting, like all RChain transactions, incurs a small charge. (The coop offset this charge with a 100 REV reward for those who registered before July 31, 2020.) Be sure you have enough in your account to cover the max transaction fee.
          
          </li><li>When you are ready, press Sign and Submit. This will bring up metamask in order to sign your rholang response.
          
          </li><li>Confirm that your transactions succeeded. It could fail if you don't have any REV.</li></small></smalla>
              </ol>
        <p>For background, see</p>
        <ul>
          <li><cite><a href="https://blog.rchain.coop/2020/07/09/notice-of-annual-meeting-2020/"
            id="meetingNotice"
                       >Notice of Annual Meeting 2020</a> RChain Blog July 9</cite></li>
          <li><a href="https://medium.com/@jimscarver/using-metamask-with-rchain-2f05311976f"
                 >Using MetaMask with RChain</a></li>

        </ul>
        <form id='ballotForm'>
          <fieldset class="panel panel-default">
            <div class="panel-body">
              <br />
              <table class="table table-condensed table-hover table-bordered">
                <thead><tr><th>ID</th><th>Short Description</th><th>Oppose</th><th>Abstain</th><th>Support</th></tr></thead>
                <tbody id="questionList">
                  <tr><td>A</td><td>a question...
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit,
                    sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris
                    nisi ut aliquip ex ea commodo consequat.
                  </td>
                    <td><input type="radio" class="choice" /></td>
                    <td><input type="radio" class="choice" /></td>
                    <td><input type="radio" class="choice" /></td>
                  </tr>
                  <tr><td>B</td><td>another question...</td>
                    <td><input type="radio" class="choice" /></td>
                    <td><input type="radio" class="choice" /></td>
                    <td><input type="radio" class="choice" /></td>
                  </tr>
                  <tr><td>C</td><td>more questions...</td>
                    <td><input type="radio" class="choice" /></td>
                    <td><input type="radio" class="choice" /></td>
                    <td><input type="radio" class="choice" /></td>
                  </tr>
                </tbody>
              </table>
              <label>
                Agenda URI:
                <input id="agendaURI" size="60" class="coop"
                       value="rho:id:5rcmyxwu8r7yywjz4qqg4ij3pox3d96joeky1gczdpf3fkaujejdxr" />
                <span id="agendaUriViz" class="btn vizHash coop"></span>
              </label>
              <div class="card">
                <div class="card-body">
                  <h3>Sign and Submit</h3>
                  <p>Your response, in rholang:</p>
                  <textarea id="response" rows="4" cols="80"></textarea>
                  <div class="setting">
                    <label id="txFee"><small>Max transaction fee: <input id="phloLimit" type="number" value="0.05" /></small></label><br />
                  </div>
                  <input id="submitResponse" type="submit" value="Sign and Submit" />
                </div>
              </div>
            </div>
          </fieldset>
        </form>
        <hr />
        <address>
          Sep 2020 by Dan Connolly<br />
          and the <a href="https://github.com/rchain-community/">RChain Community</a><br />
          <small>RCHAIN is a registered trademark of <a href="https://rchain.coop">RChain Cooperative</a>.</small>
        </address>
      </div>
    </div>
<script type="module">
import { ethereumAddress } from './_dist_/vendor/rnode-client-js/src/eth/eth-wrapper.js';

import { buildUI } from './_dist_/web/ballot.js';

window.addEventListener('DOMContentLoaded', (event) => {
  buildUI({
    ethereumAddress,
    fetch: window.fetch,
    now: Date.now,
    createElement: tag => document.createElement(tag),
    getElementById: id => document.getElementById(id),
    querySelectorAll: selector => document.querySelectorAll(selector),
  });
});
</script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
            integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
            integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>

<script type="module">
import Shepherd from 'shepherd.js';

import { addTour } from './_dist_/web/tour-help.js';

window.addEventListener('DOMContentLoaded', (event) => {
  addTour((...args) => new Shepherd.Tour(...args));
});
</script>
  </body>
</html>
